"use strict";(self.webpackChunkHelpDesk_FrontEnd=self.webpackChunkHelpDesk_FrontEnd||[]).push([[81],{8081:(j,g,n)=>{n.r(g),n.d(g,{UserModule:()=>Y});var v=n(6895),c=n(7337),a=n(4006),m=n(1954),e=n(4650),y=n(2340),U=n(7392);let P=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-message-modal"]],decls:4,vars:0,consts:[[1,"send-message"]],template:function(s,r){1&s&&(e.TgZ(0,"div",0),e._uU(1," Cambios Guardados "),e.TgZ(2,"mat-icon"),e._uU(3,"done_outline"),e.qZA()())},dependencies:[U.Hw],styles:[".send-message[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around}mat-icon[_ngcontent-%COMP%]{color:#4caf50}"]}),t})();var T=n(262),N=n(529),b=n(7009),Z=n(9978);let I=(()=>{class t{constructor(s,r,l){this.http=s,this._snackBar=r,this.authService=l,this.apiUrl=y.N.apiUrl,this.currentUserId=this.authService.getTokenId("id")}getCurrentUser(){return this.http.get(`${this.apiUrl}/auth/user/${this.currentUserId}`)}updateProfile(s){return this.http.put(`${this.apiUrl}/auth/user/${this.currentUserId}`,s).pipe((0,T.K)(r=>401===r.status||403===r.status?this._snackBar.open("Contrase\xf1a Incorrecta","Cerrar",{duration:2e3}):r))}showConfirmationMessage(){this._snackBar.openFromComponent(P,{duration:2e3})}}return t.\u0275fac=function(s){return new(s||t)(e.LFG(N.eN),e.LFG(b.ux),e.LFG(Z.e))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var w=n(4859),C=n(3546),A=n(4144),d=n(9549),M=n(3683);function J(t,o){1&t&&(e.TgZ(0,"small"),e._uU(1,"El nombre es requerido"),e.qZA())}function S(t,o){1&t&&(e.TgZ(0,"small"),e._uU(1,"El nombre es requerido"),e.qZA())}function x(t,o){1&t&&(e.TgZ(0,"small"),e._uU(1,"La contrase\xf1a es requerida"),e.qZA())}let F=(()=>{class t{constructor(s,r,l){this.userService=s,this.authService=r,this.router=l,this.hideOldPass=!0,this.hideNewPass=!0,this.userForm=new a.cw({firstname:new a.NI("",[a.kI.required]),lastname:new a.NI("",[a.kI.required]),password:new a.NI("",[a.kI.required,m.d.checkPassword]),newpassword:new a.NI("",[a.kI.required,m.d.checkPassword]),newpasswordConfirm:new a.NI("",[a.kI.required,m.d.checkPassword])},{validators:[m.d.newpasswordsMatching]}),this.userData={_id:"",email:"",firstname:"",lastname:"",createdAt:"",updatedAt:"",comments:[]}}ngOnInit(){this.user$=this.userService.getCurrentUser(),this.user$.subscribe({next:s=>{this.userData=s.user,this.userForm.patchValue({firstname:this.userData.firstname,lastname:this.userData.lastname})},error:s=>console.error(s)})}get putForm(){return this.userForm}saveChanges(){if(this.userForm.valid){const{firstname:s,lastname:r,password:l,newpassword:u}=this.putForm.value;this.userService.updateProfile({firstname:s,lastname:r,password:l,newpassword:u}).subscribe({next:()=>{this.userService.showConfirmationMessage(),this.authService.logout(),this.router.navigate(["/auth"])},error:()=>{this.userService.showConfirmationMessage(),this.authService.logout(),this.router.navigate(["/auth"])}})}}}return t.\u0275fac=function(s){return new(s||t)(e.Y36(I),e.Y36(Z.e),e.Y36(c.F0))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-profile"]],decls:46,vars:14,consts:[[1,"flex","items-center","justify-center","h-screen"],[1,"max-w-3xl","w-full"],[1,"flex","flex-wrap","items-center","h-[calc(100vh_-_64px)]","w-[100%]"],[1,"bg-white","shadow-md","rounded","w-[80%]","max-w-[350px]","block","my-0","mx-auto"],["color","primary",1,"text-lg","font-semibold","mb-4","justify-center"],[1,"my-[1.5rem]","mx-[0.5rem]","px-[0]","py-[0]"],[3,"formGroup","ngSubmit"],["appearance","outline",1,"w-full","mb-2"],["matInput","","formControlName","firstname","placeholder","Nombre"],[3,"hidden"],[4,"ngIf"],["matInput","","formControlName","lastname","placeholder","Apellidos"],["autocomplete","false","matInput","","placeholder","Contrase\xf1a *","formControlName","password",3,"type"],["aria-label","Ver contrase\xf1a","role","button","mat-icon-button","","matSuffix","",3,"click"],["autocomplete","false","matInput","","placeholder","Nueva contrase\xf1a *","formControlName","newpassword",3,"type"],["autocomplete","false","matInput","","placeholder","Confirmar nueva contrase\xf1a *","formControlName","newpasswordConfirm",3,"type"],[1,"flex","justify-end"],["mat-raised-button","","color","primary","type","submit",1,"bg-blue-500","text-white","px-4","py-2","rounded",3,"disabled"]],template:function(s,r){if(1&s&&(e.TgZ(0,"div",0)(1,"div",1)(2,"section",2)(3,"mat-card",3)(4,"mat-toolbar",4),e._uU(5,"EDITAR USUARIO"),e.qZA(),e.TgZ(6,"mat-card-content",5)(7,"form",6),e.NdJ("ngSubmit",function(){return r.saveChanges()}),e.TgZ(8,"mat-form-field",7)(9,"mat-label"),e._uU(10,"Nombre:"),e.qZA(),e._UZ(11,"input",8),e.TgZ(12,"mat-error",9),e.YNc(13,J,2,0,"small",10),e.qZA()(),e.TgZ(14,"mat-form-field",7)(15,"mat-label"),e._uU(16,"Apellidos:"),e.qZA(),e._UZ(17,"input",11),e.TgZ(18,"mat-error",9),e.YNc(19,S,2,0,"small",10),e.qZA()(),e.TgZ(20,"mat-form-field",7)(21,"mat-label"),e._uU(22,"Contrase\xf1a:"),e.qZA(),e._UZ(23,"input",12),e.TgZ(24,"button",13),e.NdJ("click",function(){return r.hideOldPass=!r.hideOldPass}),e.TgZ(25,"mat-icon"),e._uU(26),e.qZA()(),e.TgZ(27,"mat-error",9),e.YNc(28,x,2,0,"small",10),e.qZA()(),e.TgZ(29,"mat-form-field",7)(30,"mat-label"),e._uU(31,"Nueva contrase\xf1a:"),e.qZA(),e._UZ(32,"input",14),e.TgZ(33,"button",13),e.NdJ("click",function(){return r.hideNewPass=!r.hideNewPass}),e.TgZ(34,"mat-icon"),e._uU(35),e.qZA()()(),e.TgZ(36,"mat-form-field",7)(37,"mat-label"),e._uU(38,"Confirma nueva contrase\xf1a:"),e.qZA(),e._UZ(39,"input",15),e.TgZ(40,"button",13),e.NdJ("click",function(){return r.hideNewPass=!r.hideNewPass}),e.TgZ(41,"mat-icon"),e._uU(42),e.qZA()()(),e.TgZ(43,"div",16)(44,"button",17),e._uU(45,"Guardar Cambios"),e.qZA()()()()()()()()),2&s){let l,u,i,f,p,h;e.xp6(7),e.Q6J("formGroup",r.userForm),e.xp6(5),e.Q6J("hidden",(null==(l=r.userForm.get("firstname"))?null:l.valid)||(null==(l=r.userForm.get("firstname"))?null:l.pristine)),e.xp6(1),e.Q6J("ngIf",null==(u=r.userForm.get("firstname"))||null==u.errors?null:u.errors.required),e.xp6(5),e.Q6J("hidden",(null==(i=r.userForm.get("lastname"))?null:i.valid)||(null==(i=r.userForm.get("lastname"))?null:i.pristine)),e.xp6(1),e.Q6J("ngIf",null==(f=r.userForm.get("lastname"))||null==f.errors?null:f.errors.required),e.xp6(4),e.Q6J("type",r.hideOldPass?"password":"text"),e.xp6(3),e.hij(" ",r.hideOldPass?"visibility_off":"visibility"," "),e.xp6(1),e.Q6J("hidden",(null==(p=r.userForm.get("password"))?null:p.valid)||(null==(p=r.userForm.get("password"))?null:p.pristine)),e.xp6(1),e.Q6J("ngIf",null==(h=r.userForm.get("password"))||null==h.errors?null:h.errors.required),e.xp6(4),e.Q6J("type",r.hideNewPass?"password":"text"),e.xp6(3),e.Oqu(r.hideNewPass?"visibility_off":"visibility"),e.xp6(4),e.Q6J("type",r.hideNewPass?"password":"text"),e.xp6(3),e.Oqu(r.hideNewPass?"visibility_off":"visibility"),e.xp6(2),e.Q6J("disabled",r.userForm.invalid)}},dependencies:[v.O5,a._Y,a.Fj,a.JJ,a.JL,a.sg,a.u,w.lW,w.RK,C.a8,C.dn,U.Hw,A.Nt,d.KE,d.hX,d.TO,d.R9,M.Ye]}),t})();const q=[{path:"",canActivate:[n(7618).r],children:[{path:"",component:F},{path:":id",component:F,data:{title:"User Profile",mode:"edit"}}]}];let Q=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[c.Bz.forChild(q),c.Bz]}),t})();var k=n(7772);let Y=(()=>{class t{}return t.\u0275fac=function(s){return new(s||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[v.ez,Q,a.u5,a.UX,k.h]}),t})()}}]);